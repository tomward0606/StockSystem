<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Catalogue Manager (Hide Items)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    :root{
      --bg1:#0f172a;   /* slate-900 */
      --bg2:#1e293b;   /* slate-800 */
      --brd:#e5e7eb;   /* light border on white */
      --hdr-blue:#1e3a8a;
      --hdr-gray:#374151;
    }
    body{
      min-height:100vh;
      background: radial-gradient(1200px 800px at 10% -10%, #1b2a52 0%, transparent 60%),
                  radial-gradient(1000px 700px at 90% 110%, #0b3a60 0%, transparent 60%),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
    }
    .wrap{ max-width:1100px; }

    /* White main card */
    .shell{
      background:#fff;
      border:1px solid var(--brd);
      border-radius:18px;
      box-shadow:0 10px 30px rgba(0,0,0,.15);
      padding:24px;
    }

    /* Hero (inside the white shell) */
    .hero{
      border:1px solid #eef2ff;
      border-radius:14px;
      padding:16px 18px;
      background:#f8fafc;
      margin-bottom:16px;
    }
    .hero-logo{ height:42px; width:auto; display:block; border-radius:8px; }
    .hero h2{ margin:0 0 4px; font-weight:700; }
    .hero p{ margin:0; color:#64748b; }

    .card{
      border-radius:14px;
      border:1px solid var(--brd);
      overflow:hidden;
    }
    .card-header{ color:#fff; }
    .card-header.hdr-blue{ background:var(--hdr-blue); }
    .card-header.hdr-gray{ background:var(--hdr-gray); }
    .form-text{ color:#6b7280; }

    code{ background:#f3f4f6; padding:.15rem .35rem; border-radius:6px; }

    @media (max-width: 576px){
      .shell{ padding:16px; }
      .hero{ padding:12px 14px; }
      .hero-logo{ height:36px; }
    }
  </style>
</head>
<body class="py-4">
  <div class="container wrap">
    <div class="shell">

      <!-- Hero -->
      <div class="hero d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
          <img src="{{ url_for('static', filename='logo.png') }}" alt="Servitech logo" class="hero-logo">
          <div>
            <h2 class="h4 mb-1">Catalogue Manager</h2>
            <p>Hide items from the engineer catalogue — fully reversible.</p>
          </div>
        </div>
        <a class="btn btn-outline-secondary" href="{{ url_for('parts_orders_list') }}">Back to Admin</a>
      </div>

      <!-- Hide a Part -->
      <div class="card mb-4">
        <div class="card-header hdr-blue">Hide a Part</div>
        <div class="card-body">
          <form method="post" action="{{ url_for('hidden_parts') }}" class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Part Number</label>
              <input name="part_number" class="form-control" placeholder="e.g. TEST-BOLT-M6" required>
              <div class="form-text">Exact part number from the catalogue (case-insensitive).</div>
            </div>
            <div class="col-md-5">
              <label class="form-label">Reason (optional)</label>
              <input name="reason" class="form-control" placeholder="Obsolete / replaced / error">
            </div>
            <div class="col-md-3">
              <label class="form-label">Your name (optional)</label>
              <input name="created_by" class="form-control" placeholder="Admin name">
            </div>
            <div class="col-12 text-end">
              <button class="btn btn-primary">
                <i class="bi bi-eye-slash me-1"></i> Hide Part
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Current Hidden Parts -->
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center hdr-gray">
          <span>Currently Hidden</span>
          <span class="badge bg-light text-dark">{{ rows|length if rows else 0 }}</span>
        </div>
        <div class="card-body">
          {% if rows %}
          <div class="table-responsive">
            <table class="table table-sm table-bordered align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th>Part Number</th>
                  <th>Reason</th>
                  <th>Hidden By</th>
                  <th>Hidden At</th>
                  <th style="width:1%"></th>
                </tr>
              </thead>
              <tbody>
                {% for r in rows %}
                <tr>
                  <td><code>{{ r.part_number }}</code></td>
                  <td>{{ r.reason or '—' }}</td>
                  <td>{{ r.created_by or '—' }}</td>
                  <td>{{ r.created_at.strftime('%d %b %Y %H:%M') }}</td>
                  <td>
                    <!-- Post the value in the body, not the URL -->
                    <form method="post" action="{{ url_for('unhide_part') }}"
                          onsubmit="return confirm('Unhide {{ r.part_number }}?');">
                      <input type="hidden" name="part_number" value="{{ r.part_number }}">
                      <button class="btn btn-sm btn-outline-danger">
                        <i class="bi bi-eye"></i> Unhide
                      </button>
                    </form>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
            <p class="text-muted mb-0">Nothing hidden.</p>
          {% endif %}
        </div>
      </div>

    </div>
  </div>
</body>
</html>
